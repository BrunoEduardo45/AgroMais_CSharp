@model AgroMais.Models.Clientes

@using AgroMais.Models

@{
    ViewData["Title"] = "Clientes";
}

<div id="header" class="no-print">
    <div id="topo">
        <h3><i class="fa fa-users topo"></i>Lista de clientes cadastrados</h3>
        <div id="div-btn-add">
            <p>Cadastrar novo cliente</p>
            <a id="btn-add" href="/Home/addCliente" style="text-decoration:none;"><i class="fa fa-plus"></i></a>
        </div>
    </div>
</div>
<div id="container" class="no-print">
    <div id="lista">
        <table id="datatable" class="dataTable compact hover order-column row-border" style="width:100%">
            <thead>
                <tr>
                    <th class="col-md-3">Nome</th>
                    <th class="col-md-3">Endereço</th>
                    <th class="col-md-2">Telefone</th>
                    <th class="col-md-2">Qtd. serviços</th>
                    <th class="col-md-2"></th>
                </tr>
            </thead>
            <tbody>
                @if (Model.listaclientes.Count() > 0)
                {
                    foreach (var cliente in Model.listaclientes)
                    {
                        <tr id="Cliente_@cliente.CLI_ID" value="@cliente.CLI_ID">
                            <th class="col-md-3 texto-lista">@cliente.CLI_NOME </th>
                            <td class="col-md-3 texto-lista">@cliente.CLI_MUNICIPIO</td>
                            <td class="col-md-2 texto-lista">@cliente.CLI_TELEFONE</td>
                            <td class="col-md-2 texto-lista">3</td>
                            <td class="col-md-2" style="text-align:right;">
                                <button class="btn btn-primary btn-lista" id="" onclick="abrirModalDetalhesCliente(@cliente.CLI_ID)"><i class="fa fa-search"></i></button>
                                <button class="btn btn-warning btn-lista"><i class="fa fa-pencil" style="color: #fff;"></i></button>
                                <button class="btn btn-danger btn-lista" id="" onclick="DeletarCliente(@cliente.CLI_ID)"><i class="fa fa-trash"></i></button>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td><span>Nenhum cliente encontrado</span></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="modal" id="modal_detalhes">
    <img src="/Content/img/CIMA.jpg" id="topo-modal" class="print">
    <div class="modal-content" id="modal-content-detalhes">
        <div class="btn-modal no-print" style="text-align: right;">
            <button class="btn btn-danger close" onclick="fecharModalDetalhes()" id="close"><i class="fa fa-close"></i></button>
        </div>
        <div id="info-modal" class="conteudo exemplo">
            @*<h1 class="titulo-modal">Informações do cliente</h1>
            <input type="hidden" value="" id="id_cliente"/>
            <p><b>Nome: </b>@Model.listaclientes[1].CLI_NOME</p>
            <p><b>CPF: </b>@Model.listaclientes[Model.ID].CLI_CPF</p>
            <p><b>CNPJ: </b>@Model.listaclientes[Model.ID].CLI_CNPJ</p>
            <p><b>RG: </b>@Model.listaclientes[Model.ID].CLI_RG</p>
            <p><b>Idade: </b>@Model.listaclientes[Model.ID].CLI_IDADE</p>
            <p><b>Data de Nascimento: </b>@Model.listaclientes[Model.ID].CLI_DATA_NASC</p>
            <p><b>Profissão: </b>@Model.listaclientes[Model.ID].CLI_PROFISSAO</p>
            <p><b>Telefone: </b>@Model.listaclientes[Model.ID].CLI_TELEFONE</p>
            <p><b>Celular: </b>@Model.listaclientes[Model.ID].CLI_CELULAR</p>
            <p><b>Email: </b>@Model.listaclientes[Model.ID].CLI_EMAIL</p>
            <p><b>Endereço completo: </b>@Model.listaclientes[Model.ID].CLI_LOGRADOURO, N°@Model.listaclientes[Model.ID].CLI_NUMERO, @Model.listaclientes[Model.ID].CLI_BAIRRO, @Model.listaclientes[Model.ID].CLI_MUNICIPIO - @Model.listaclientes[Model.ID].CLI_UF. CEP:@Model.listaclientes[Model.ID].CLI_CEP</p>
            <br>
            <br>*@
        </div>
        <div class="btn-modal no-print" style="text-align: center;">
            <button class="btn btn-success" onclick="window.print()"><i class="fa fa-print"></i></button>
            <p>Imprimir</p>
        </div>
    </div>
    <img src="/Content/img/BAIXO.jpg" id="base-modal" class="print">
</div>

<script>
    function abrirModalDetalhesCliente(id) {
        var a = $('#id_cliente').val(id);

        document.querySelector("#info-modal").innerHTML = '<h1 class="titulo-modal">Informações do cliente</h1>' + 
            '<input type="hidden" value="" id="id_cliente"/>' +
            '<p><b>Nome: </b>" +@Model.listaclientes[1].CLI_NOME +"</p>' +
                '<p><b>CPF: </b>" +@Model.listaclientes[Model.ID].CLI_CPF +"</p>' +
                '<p><b>CNPJ: </b>" +@Model.listaclientes[Model.ID].CLI_CNPJ +"</p>' +
                '<p><b>RG: </b>" +@Model.listaclientes[Model.ID].CLI_RG +"</p>' +
                '<p><b>Idade: </b>" +@Model.listaclientes[Model.ID].CLI_IDADE +"</p>' +
                '<p><b>Data de Nascimento: </b>" +@Model.listaclientes[Model.ID].CLI_DATA_NASC +"</p>' +
                '<p><b>Profissão: </b>" +@Model.listaclientes[Model.ID].CLI_PROFISSAO +"</p>' +
                '<p><b>Telefone: </b>" +@Model.listaclientes[Model.ID].CLI_TELEFONE +"</p>' +
                '<p><b>Celular: </b>" +@Model.listaclientes[Model.ID].CLI_CELULAR +"</p>' +
                '<p><b>Email: </b>" +@Model.listaclientes[Model.ID].CLI_EMAIL +"</p>' +
                '<p><b>Endereço completo: </b>' +
                @Model.listaclientes[Model.ID].CLI_LOGRADOURO + ', N°' +
                @Model.listaclientes[Model.ID].CLI_NUMERO +', ' +
                @Model.listaclientes[Model.ID].CLI_BAIRRO +', ' +
                @Model.listaclientes[Model.ID].CLI_MUNICIPIO +' - ' +
                @Model.listaclientes[Model.ID].CLI_UF +'. CEP:' +
                @Model.listaclientes[Model.ID].CLI_CEP +'</p>' + '<br><br>';








        debugger;
        $('#modal_detalhes').val('modal-show');
        $('#modal-content-detalhes').addClass('modal-content-show');
    }
    function fecharModalDetalhes() {
        $('#modal_detalhes').removeClass('modal-show');
        $().removeClass('modal-content-show');
    }
    function DeletarCliente(id) {
        debugger;
        $.ajax({
            type: 'post',
            url: '@Url.Action("DeletarCliente", "Home")',
            data: id,
            dataType: 'json',
            success: function (retorno) {
                removePreload();
                if (retorno.erro === false)
                {
                    ShowMensagem(retorno.mensagem, retorno.status, 3000);
                    setTimeout(function () { document.location.reload(true); }, 2000);
                }
                else {
                    ShowMensagem(retorno.mensagem, retorno.status, 3000);
                }
                resultado = true;
            },
            error: function (xhr, ajaxOptions, thrownError) {
                removePreload();
                ShowMensagem(thrownError, "ERRO", 3000);
            }
        });
    };
</script>